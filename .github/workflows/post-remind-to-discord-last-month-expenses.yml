name: Scheduled End of Month Job

on:
  schedule:
    # 毎月28日から31日の18時 (UTC) に実行
    - cron:  '0 18 28-31 * *'

jobs:
  end-of-month-task:
    runs-on: ubuntu-latest
    steps:
      - name: Run task if today is the last day of the month
        run: |
          if [ "$(date +\%d -d tomorrow)" == "01" ]; then
            echo "Running end-of-month tasks."
          else
            echo "Today is not the last day of the month. No action taken."
            exit 1
          fi
      - name: Notify Discord
        run: |
          curl -H "Content-Type: application/json" \
          -X POST \
          -d '{
            "content": "----------\n🐶明日は家計簿締め日！🐶\n先月分で記載忘れ・間違いがないか確認しましょう。\n----------
          }' \
          ${{ secrets.DISCORD_LAST_MONTH_WEBHOOK_URL }}
